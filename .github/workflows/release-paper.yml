name: Release Paper PDF

on:
  push:
    tags:
      # Only trigger for tags ending in "-paper"
      - "v*-paper"

jobs:
  release:
    name: Release PDF
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Find PDF
        id: pdf
        run: |
          # Adjust the filename here if needed
          FILE_PATH=$(find . -maxdepth 3 -type f -iname "main.pdf")
          if [ -z "$FILE_PATH" ]; then
            echo "ERROR: Could not find main.pdf"
            exit 1
          fi
          echo "path=$FILE_PATH" >> $GITHUB_OUTPUT

      - name: Create GitHub Release
        id: create_release
        uses: softprops/action-gh-release@v2
        with:
          tag_name: ${{ github.ref_name }}
          name: Release ${{ github.ref_name }}
          draft: false
          prerelease: false
          generate_release_notes: true
          files: |
            ${{ steps.pdf.outputs.path }}#AIon-Computational-Holography-${{ github.ref_name }}.pdf
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}